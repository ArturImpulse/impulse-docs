# üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

## üóÑÔ∏è –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

–ì–ª–∞–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ **`settings`**:

| –ü–æ–ª–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|:------|:-------------|
| `id` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `key` | –ö–ª—é—á –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `value` | –ó–Ω–∞—á–µ–Ω–∏–µ |
| `type` | –¢–∏–ø –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| üîí –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å | `key + type` |

üìÑ **–ú–∏–≥—Ä–∞—Ü–∏—è:** `migrations/m231208_094545_create_settings_table.php` (—Å—Ç—Ä–æ–∫–∞ 15)

---

## ‚öôÔ∏è –ü–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –±–∞–∑–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

- üìÑ `m240704_221737_insert_settings_custom.php` (—Å—Ç—Ä–æ–∫–∞ 13) ‚Äî –±–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (school, journal_homework –∏ –¥—Ä.)  
- üìÑ `m240812_221737_insert_journal_settings_custom.php` (—Å—Ç—Ä–æ–∫–∞ 13) ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- `isParentCanStartChat` ‚Üí üìÑ `m250821_203333_add_flag_isParentCanStartChat_in_settings.php` (—Å—Ç—Ä–æ–∫–∞ 19)

---

## üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `notification_settings`
- `notification_contents`
- `notification_triggers`

üìÑ –°–æ–∑–¥–∞—é—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏–µ–π `m241217_144926_create_notification_settings_table.php` (—Å—Ç—Ä–æ–∫–∞ 19)

### –ú–æ–¥–µ–ª–∏:
| –¢–∞–±–ª–∏—Ü–∞ | –ú–æ–¥–µ–ª—å | –°—Ç—Ä–æ–∫–∞ |
|:----------|:----------|:----------|
| `notification_settings` | `modules/v1/models/NotificationSetting.php` | 12 |
| `notification_contents` | `modules/v1/models/NotificationContent.php` | 15 |
| `notification_triggers` | `modules/v1/models/NotificationTrigger.php` | 17 |

---

## üß† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ü—Ä–∏–º–µ—Ä—ã –∫–ª—é—á–µ–π:
- `autoCheckHomeWork`
- `techSupportUsers`
- `customEmailConfirmationMessage`

–ß—Ç–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑:

```php
Setting::getValue('key_name');
```

üìÑ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
- `modules/v1/controllers/HomeWorkController.php` (—Å—Ç—Ä–æ–∫–∞ 966)
- `modules/v1/controllers/IntegrationConfigsController.php` (—Å—Ç—Ä–æ–∫–∞ 253)

---

## üß© –ö–æ–¥ –∏ API

### –ú–æ–¥–µ–ª—å

üìÑ `modules/v1/models/Setting.php` (—Å—Ç—Ä–æ–∫–∞ 12)

- –û–ø–∏—Å—ã–≤–∞–µ—Ç `ActiveRecord`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:
  - `general`
  - `menu`
  - `custom`
  - `notifications`
  - `payment_system`
  - `crm`
- –ú–µ—Ç–æ–¥—ã:
  - `getValue()`
  - `setValue()`

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

üìÑ `modules/v1/repositories/SettingRepository.php` (—Å—Ç—Ä–æ–∫–∞ 12)

–ò–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç CRUD‚Äë–æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ —Ä–∞–±–æ—Ç—É —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏:
- `getAll()`
- `update()`
- `getNotificationSettings()`
- `saveNotificationContent()`
- `updateNotificationType()`

### REST‚Äë–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

üìÑ `modules/v1/controllers/SettingController.php` (—Å—Ç—Ä–æ–∫–∞ 107)

–ú–µ—Ç–æ–¥—ã:
- `actionGetAll` (GET)
- `actionUpdateSetting` (PUT)
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:
  - `actionUploadLogo`
  - `actionUpdateAuthImage`
  - `actionUpdateCatalogImage`
  - `actionUpdatePayByRequisitesImage`
- –°–ø–µ—Ü‚Äë–¥–µ–π—Å—Ç–≤–∏—è: `actionRegenerateApiCreds`

---

## üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

–§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ **use‚Äëcase –∫–ª–∞—Å—Å—ã**:

| –ö–ª–∞—Å—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç—Ä–æ–∫–∞ |
|:---------|:-------------|:---------|
| `ChangeMainLogoHandler.php` | –ó–∞–º–µ–Ω–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ | 10 |
| `SaveAuthImageUseCase.php` | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | 13 |
| `SaveCatalogImageUseCase.php` | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ | 13 |
| `SavePayByRequisitesImage.php` | –ö–∞—Ä—Ç–∏–Ω–∫–∞ –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π | 13 |

–§–∞–π–ª—ã –∫–ª–∞–¥—É—Ç—Å—è –≤ `web/upload`, –∞ –ø—É—Ç—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `settings`.

---

## üåê –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

üìÑ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä: `modules/v1/controllers/IntegrationConfigsController.php` (—Å—Ç—Ä–æ–∫–∞ 233)

- –ú–∞—Å—Å–æ–≤–æ –≤—ã–∑—ã–≤–∞–µ—Ç `Setting::setValue()`  
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

---

## üß© –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–ª–∞–≥–∏ –ø–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Yii::$app->settings` —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤:

üìÑ `config/web.php` (—Å—Ç—Ä–æ–∫–∞ 150)  
‚Üí –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `modules/v1/services/SettingsContainerService.php` (—Å—Ç—Ä–æ–∫–∞ 9)

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–±—É–ª–µ–≤—ã —Ñ–ª–∞–≥–∏** –∏–∑ –º–∞—Å—Å–∏–≤–∞ `partners` –≤ `config/params.php` (—Å—Ç—Ä–æ–∫–∞ 31)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

üìÑ `modules/v1/components/AutoRenewalManager.php` (—Å—Ç—Ä–æ–∫–∞ 55)

```php
Yii::$app->settings->get('orders_auto_renewal');
```

–ï—Å–ª–∏ –±–ª–æ–∫ `params['partners']` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî  
–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** (`config/params.php`, —Å—Ç—Ä–æ–∫–∞ 33).

---

## üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ SQL‚Äë–∑–∞–ø—Ä–æ—Å–æ–º:

```sql
SELECT key, value, type FROM settings;
```

–ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ REST‚Äë—ç–Ω–¥–ø–æ–π–Ω—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
