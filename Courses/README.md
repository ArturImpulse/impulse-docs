# üìö –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ö—É—Ä—Å–æ–≤

## üß≠ –û–±—â–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

**Direction** –∑–∞–¥–∞—ë—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Ç–∞—Ä–∏—Ñ—ã, –≥—Ä—É–ø–ø—ã –∏ –∑–∞–∫–∞–∑—ã.  
–ß–µ—Ä–µ–∑ —Å–≤—è–∑–∏ `directionCourses`, `directionGroups`, `directionOrders` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–µ—Ö –∫—É—Ä—Å–æ–≤.  
üìÑ `modules/v1/models/Direction.php` (line 1)

**DirectionCourse** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫/–∫—É—Ä—Å –≤–Ω—É—Ç—Ä–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.  
–¢–∞–±–ª–∏—Ü–∞: `direction_course`; —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Å–≤—è–∑–∏ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∏ –ø–ª–∞–Ω–∞–º–∏.  
üìÑ `modules/v1/models/DirectionCourse.php` (line 14)

**–¢–µ–º—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã**:  
- `CourseMaterial` (—Ç–∞–±–ª–∏—Ü–∞ `course_material`) –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ–º—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ, –ø—Ä–æ–±–Ω–∏–∫–∏ –∏ —Ç.–ø.  
- –î–ª—è –∫—É—Ä—Å–æ–≤ –±–µ–∑ —Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CourseThemes` (—Ç–∞–±–ª–∏—Ü–∞ `course_themes`) –∫–∞–∫ ¬´–ø–æ–¥—É—Ä–æ–≤–µ–Ω—å¬ª –º–µ–∂–¥—É –∫—É—Ä—Å–æ–º –∏ —É—Ä–æ–∫–∞–º–∏.  
üìÑ `modules/v1/models/CourseMaterial.php` (line 14), `modules/v1/models/CourseThemes.php` (line 1)

**–£—Ä–æ–∫–∏**:  
`TopicLesson` (—Ç–∞–±–ª–∏—Ü–∞ `topic_lesson`) —Ö—Ä–∞–Ω–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –∑–∞–Ω—è—Ç–∏—è, —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã/SCORM, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –î–ó.  
–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –¥–æ—Å—Ç—É–ø–∞ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å.  
üìÑ `modules/v1/models/TopicLesson.php` (line 1)

---

## üîë –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –¥–æ—Å—Ç—É–ø

- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫—É—Ä—Å–∞ `DirectionPlanService::addNewCourseToPlan()` —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `course_plan` –¥–ª—è **–≥—Ä—É–ø–ø–æ–≤—ã—Ö** –∏ **–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö** –∑–∞–∫–∞–∑–æ–≤, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è —Å—Ç–∞—Ç—É—Å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–∞—Ä–∏—Ñ–∞.  
  üìÑ `modules/v1/services/DirectionPlanService.php` (line 20)

- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã/—Ç–µ–º—ã –ø–æ–ª—É—á–∞—é—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤ `material_plan`; –º–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–∏—Å–∞ —É—á–∏—Ç—ã–≤–∞—é—Ç ¬´–≤–∏–¥–∏–º–æ—Å—Ç—å –∫—É—Ä—Å–æ–≤¬ª, —á—Ç–æ–±—ã **–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ—ç—Ç–∞–ø–Ω–æ**.  
  üìÑ `modules/v1/services/DirectionPlanService.php` (line 114)

- `AccessService::openAccess()` —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å–∏ –≤ `access_to_material`, –≤—ã–¥–∞–≤–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ä–µ–±—ë–Ω–∫—É –¥–æ—Å—Ç—É–ø –∫ –±–ª–æ–∫—É/—Ç–µ–º–µ/—É—Ä–æ–∫—É.  
  –î–æ–ø. —Ö–µ–ª–ø–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `grantAccessToNewFirstBlock()`) –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞.  
  üìÑ `modules/v1/services/AccessService.php` (lines 622, 652)

- **–ü—Ä–æ–≥—Ä–µ—Å—Å**: `DynamicsCourseService::initLessonUserRecords()` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `lesson_user` –∏ `dynamics_course`, —á—Ç–æ–±—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (–ø—Ä–æ—Ü–µ–Ω—Ç, —Å—Ç–∞—Ç—É—Å, –¥–∞—Ç—ã) –∏ –¥–∞—Ç—å —Å–∏—Å—Ç–µ–º–µ —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.  
  üìÑ `modules/v1/services/DynamicsCourseService.php` (line 22)

---

## üõ†Ô∏è API –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω—ã–µ CRUD –∏ –±–∏–∑–Ω–µ—Å‚Äë–æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ REST‚Äë–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö:

- `DirectionCourseController` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —Å–±—Ä–æ—Å –¥–∏–Ω–∞–º–∏–∫–∏.  
  üìÑ `modules/v1/controllers/DirectionCourseController.php` (line 97)

- `CourseMaterialController` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.  
  üìÑ `modules/v1/controllers/CourseMaterialController.php` (line 1)

- `DirectionPlanController` ‚Äî –≤—ã–¥–∞—á–∞ –ø–ª–∞–Ω–∞ —É—á–µ–Ω–∏–∫—É/–≥—Ä—É–ø–ø–µ.  
  üìÑ `modules/v1/controllers/DirectionPlanController.php` (line 1)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ `POST /v1/direction-course` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `afterAction`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –ø–ª–∞–Ω‚Äë—Å–µ—Ä–≤–∏—Å, `AccessService` –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞; —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞ **201** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å.  
üìÑ `modules/v1/controllers/DirectionCourseController.php` (lines 97‚Äì195)

–í—Å—è ¬´–Ω–∞–∑–Ω–∞—á–∞–µ–º–æ—Å—Ç—å¬ª —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã `AssignableEntityInterface` / `AssignmentInterface`  
(–∫—É—Ä—Å—ã, –º–∞—Ç–µ—Ä–∏–∞–ª—ã, —É—Ä–æ–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–ª–∞–Ω—ã —á–µ—Ä–µ–∑ `createAssignment`).  
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏/—Ç–∏–ø—ã –ø–ª–∞–Ω–∞, **–Ω–µ –ª–æ–º–∞—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**.  
üìÑ `modules/v1/models/DirectionCourse.php` (line 189), `modules/v1/models/CourseMaterial.php` (line 201), `modules/v1/models/TopicLesson.php` (line 229)

**–ó–∞–∫–∞–∑—ã** (`DirectionOrders`) + **—Ç–∞—Ä–∏—Ñ—ã** (`DirectionTariff`) –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∏ –≤ –∫–∞–∫–æ–º —Ä–µ–∂–∏–º–µ (–æ—Ç–∫—Ä—ã—Ç—ã–π, –ª–∏–Ω–µ–π–Ω—ã–π –∏ —Ç.–ø.).  
–≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.  
üìÑ `modules/v1/services/AccessService.php` (line 695), `modules/v1/services/DirectionPlanService.php` (line 55)

> üîé –î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: –ø—Ä–æ–∫–ª–∏–∫–∞—Ç—å `POST /v1/direction-course` –∏ `GET /v1/direction-plan` –≤ dev‚Äë–æ–∫—Ä—É–∂–µ–Ω–∏–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π JSON.  
> –î–ª—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ ‚Äî —Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–µ —Ñ–ª–∞–≥–∏ `visibility_cources` –∏ –≤–µ—Ç–∫–∏ –≤ `AccessService::processOrderAccess()`.

---

## ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/direction-course`  
–û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è `DirectionCourseController::actionCreate()` –∏ `afterAction()`.  
–ú–µ—Ç–æ–¥ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç `sorting`, —á—Ç–æ–±—ã –Ω–æ–≤—ã–π –∫—É—Ä—Å –æ–∫–∞–∑–∞–ª—Å—è **–≤ –∫–æ–Ω—Ü–µ** —Å–ø–∏—Å–∫–∞ –±–ª–æ–∫–æ–≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.  
üìÑ `modules/v1/controllers/DirectionCourseController.php` (lines 97‚Äì195)

**–ú–æ–¥–µ–ª—å `DirectionCourse`** ‚Üî —Ç–∞–±–ª–∏—Ü–∞ `direction_course`  
–ü–æ–ª—è: `id`, `direction_id`, `name/short_name`, `code`, `status`, `view`, `description`, `sorting`, `created_at/updated_at`  
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–π–º—Å—Ç–µ–º–ø—ã.  
üìÑ `modules/v1/models/DirectionCourse.php` (lines 14‚Äì197)  
üìÑ –ú–∏–≥—Ä–∞—Ü–∏—è: `migrations/m220328_044123_create_direction_course_table.php`

---

## üîÑ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

1. `DirectionPlanService::addNewCourseToPlan()` —Ä–∞–∑–≤–µ—à–∏–≤–∞–µ—Ç –∫—É—Ä—Å –Ω–∞ –≤—Å–µ **–≥—Ä—É–ø–ø—ã** –∏ **–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã** –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, —Å–æ–∑–¥–∞–≤–∞—è –∑–∞–ø–∏—Å–∏ –≤ `course_plan`  
   (—Ç–∏–ø `group/private`, —Å—Ç–∞—Ç—É—Å –ø–æ —Ç–∞—Ä–∏—Ñ—É, `order_id`).  
   üìÑ `modules/v1/services/DirectionPlanService.php` (lines 20‚Äì111)  
   üìÑ –ú–∏–≥—Ä–∞—Ü–∏–∏: `m220822_101538_create_course_plan_table.php` –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è (`m220822_102040`, `m220826_054459`, `m221108_102150`).

2. –î–ª—è —Ç–∞—Ä–∏—Ñ–æ–≤ —Å **–æ—Ç–∫—Ä—ã—Ç–æ–π –≤–∏–¥–∏–º–æ—Å—Ç—å—é** controller –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º –∑–∞–∫–∞–∑–∞–º —Å `visibility_cources = 1` –≤—ã–∑—ã–≤–∞–µ—Ç `AccessService::openAccess()`, –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `access_to_material` (`child_id`, `foreign_id`, `foreign_class`, `order_id`).  
   üìÑ `modules/v1/controllers/DirectionCourseController.php` (lines 111‚Äì139), `modules/v1/services/AccessService.php` (lines 622‚Äì643).

3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `AccessService::grantAccessToNewFirstBlock()` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç **–ø–µ—Ä–≤—ã–π –±–ª–æ–∫/—Ç–µ–º—É/—É—Ä–æ–∫** –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –∑–∞–∫–∞–∑–∞–º.  
   üìÑ `modules/v1/services/AccessService.php` (lines 652‚Äì692).

4. –î–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `DynamicsCourseService::initLessonUserRecords()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ `dynamics_course` –∏ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç `lesson_user` **–≤—Å–µ–º–∏ –±–ª–æ–∫–∞–º–∏/—Ç–µ–º–∞–º–∏/—É—Ä–æ–∫–∞–º–∏** –¥–ª—è —Ä–µ–±—ë–Ω–∫–∞.  
   üìÑ `modules/v1/controllers/DirectionCourseController.php` (lines 141‚Äì162), `modules/v1/services/DynamicsCourseService.php` (lines 22‚Äì159).

---

## üßæ –†–µ–∑—é–º–µ

- `Direction` –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∫—É—Ä—Å—ã, –≥—Ä—É–ø–ø—ã, –∑–∞–∫–∞–∑—ã).  
- `DirectionCourse` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫ –∫—É—Ä—Å–∞ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∏ —Å–≤—è–∑—è–º–∏.  
- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã/—Ç–µ–º—ã –∏ —É—Ä–æ–∫–∏ –∂–∏–≤—É—Ç –≤ `course_material` / `course_themes` –∏ `topic_lesson`.  
- –î–æ—Å—Ç—É–ø –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ `DirectionPlanService`, `AccessService`, `DynamicsCourseService`.  
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–∞–∑–Ω–∞—á–∞–µ–º–æ—Å—Ç–∏ (`AssignableEntityInterface`, `AssignmentInterface`) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∫—É—Ä—Å–∞.
