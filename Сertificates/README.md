# üèÜ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

## üìÇ –•—Ä–∞–Ω–µ–Ω–∏–µ

### –¢–∞–±–ª–∏—Ü—ã –∏ –º–æ–¥–µ–ª–∏

- **–®–∞–±–ª–æ–Ω—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `certificate_templates`.  
  üìÑ –ú–æ–¥–µ–ª—å: `modules/v1/models/CertificateTemplate.php` (—Å—Ç—Ä–æ–∫–∏ 8‚Äì63)  
  - –ü–æ–ª–µ `content` —Ö—Ä–∞–Ω–∏—Ç **JSON-–æ–ø–∏—Å–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤**.  
  - –ü–æ–ª–µ `background_id` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ñ–∞–π–ª –≤ —Ç–∞–±–ª–∏—Ü–µ `user_files`.

- **–í—ã–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —É—á–µ–Ω–∏–∫–∞–º) —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `certificate_data`.  
  üìÑ –ú–æ–¥–µ–ª—å: `modules/v1/models/CertificateData.php` (—Å—Ç—Ä–æ–∫–∏ 8‚Äì102)  
  –í –Ω–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:  
  - `course_id`  
  - `child_id`  
  - `template_id`  
  - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥  
  - –¥–∞—Ç—ã –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ —à–∞–±–ª–æ–Ω.

---

## ‚öôÔ∏è –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

üìÑ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä: `modules/v1/controllers/CertificatesController.php` (—Å—Ç—Ä–æ–∫–∏ 241‚Äì317)

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å:

```
GET /v1/certificates/get-certificate
```

### –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ –ª–æ–≥–∏–∫–∏:
1. –ò—â–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ / –≥—Ä—É–ø–ø—É.  
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `certificate_template_id`.  
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω.  
4. –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –≤ `certificate_data` –µ—â—ë –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë—Ç –µ—ë —Å **–Ω–æ–≤—ã–º 6‚Äë–∑–Ω–∞—á–Ω—ã–º –∫–æ–¥–æ–º**.

---

## üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

–ü–æ–ª–µ `certificate_template_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `direction`  
üìÑ `modules/v1/models/Direction.php` (—Å—Ç—Ä–æ–∫–∏ 11‚Äì138)  
–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –∫—É—Ä—Å –∫ –Ω—É–∂–Ω–æ–º—É —à–∞–±–ª–æ–Ω—É.

–ü–∞—Ä–∞–º–µ—Ç—Ä `expand=background` –≤ –∑–∞–ø—Ä–æ—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `user_files`  
—á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `CertificateTemplate::getBackground()`.

---

# üìú API: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ **JWT Bearer**, —á—Ç–æ –∏ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–∫—à–µ–Ω–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

## üö© –ú–∞—Ä—à—Ä—É—Ç
**–ú–µ—Ç–æ–¥ –∏ –ø—É—Ç—å:** `POST /v1/certificates/save-certificate-data`

## üßæ –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON)
–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî `courseIdOrGroupId`. –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã.

```json
{
  "courseIdOrGroupId": 123,
  "type": "course",              
  "data_fields": {
    "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "course_name": "–ö—É—Ä—Å A",
    "duration": "48 –∞–∫–∞–¥–µ–º. —á–∞—Å–æ–≤",
    "issue_date": "2024-05-25"
  }
}
```

- `type`: —Å—Ç—Ä–æ–∫–∞, `course` –∏–ª–∏ `group` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `course`).
- –í–º–µ—Å—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ `data_fields` –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–µ –∂–µ –ø–æ–ª—è **–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ**:
  ```json
  {
    "courseIdOrGroupId": 123,
    "type": "group",
    "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "course_name": "–ö—É—Ä—Å A",
    "duration": "48 –∞–∫–∞–¥–µ–º. —á–∞—Å–æ–≤",
    "issue_date": "2024-05-25"
  }
  ```

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `data_fields`.

---

## ‚úÖ –û—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ

```json
{
  "success": true,
  "data": {
    "data_fields": {
      "id": 1,
      "course_id": 123,
      "child_id": 456,
      "template_id": 789,
      "code": "000123",
      "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "course_name": "–ö—É—Ä—Å A",
      "duration": "48 –∞–∫–∞–¥–µ–º. —á–∞—Å–æ–≤",
      "issue_date": "2024-05-25",
      "created_at": "2024-05-25 12:00:00",
      "updated_at": "2024-05-25 12:00:00"
    }
  }
}
```

`POST /v1/certificates/save-certificate-data` **—Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç** –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `certificate_data` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ—ë –ø–æ–ª—è.

---

## üö´ –û—à–∏–±–∫–∏
–û—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, —á—Ç–æ –∏ –≤ `actionGetCertificate()`. –ü—Ä–∏–º–µ—Ä—ã:
- `–ì—Ä—É–ø–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`
- `–®–∞–±–ª–æ–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω`
- –ò –¥—Ä—É–≥–∏–µ –±–∏–∑–Ω–µ—Å‚Äë–≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## ‚ÑπÔ∏è –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

–≠–∫—à–µ–Ω —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤:  
üìÑ `modules/v1/controllers/CertificatesController.php`

- `actionSaveCertificateData()` ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ** —Å –¥–∞–Ω–Ω—ã–º–∏: —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç `certificate_data`.
- `actionGetCertificate()`:
  1. –ù–∞—Ö–æ–¥–∏—Ç **–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ / –≥—Ä—É–ø–ø—É**,
  2. –°–æ–∑–¥–∞—ë—Ç (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) `CertificateData` —Å **–∫–æ–¥–æ–º** –∏ **–ø–æ–ª—è–º–∏**,
  3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å **`certificate_template`** –∏ **`data_fields`**.

> ‚ö†Ô∏è –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ **–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è** HTML/PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è/—Ä–µ–Ω–¥–µ—Ä –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.

---

## üß± –°—Å—ã–ª–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- `certificate_templates` ‚Äî —à–∞–±–ª–æ–Ω—ã (—Ñ–æ–Ω, JSON-–±–ª–æ–∫–∏)
- `certificate_data` ‚Äî –≤—ã–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–ø–æ–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏, –∫–æ–¥)
- `user_files` ‚Äî —Ñ–∞–π–ª—ã —Ñ–æ–Ω–æ–≤ (—á–µ—Ä–µ–∑ `CertificateTemplate::getBackground()` / `expand=background`)

---

## üß† –ü–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å

- –ú–∞–∫–µ—Ç—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ ‚Äî –≤ —Ç–∞–±–ª–∏—Ü–µ **`certificate_templates`**  
- –í—ã–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Äî –≤ —Ç–∞–±–ª–∏—Ü–µ **`certificate_data`**  
- –§–æ–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã ‚Äî –≤ —Ç–∞–±–ª–∏—Ü–µ **`user_files`**

–í—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ SQL‚Äë–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏.

